{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('input'),\n  loadBtn: document.querySelector('.load-more'),\n};\n\nconst KEY = '41029112-ec6e065fca3f0d308b81a7ee5';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nlet page = 1;\nlet searchQuery = null;\n\nrefs.form.addEventListener('submit', async event => {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n  page = 1;\n\n  searchQuery = refs.input.value.trim();\n\n  if (!searchQuery) {\n    return;\n  }\n  fetchImages(page, searchQuery).then(value => makeCards(value));\n});\n\nrefs.loadBtn.addEventListener('click', loadMore);\n\nasync function loadMore() {\n  refs.loadBtn.classList.add('hidden');\n  page += 1;\n  fetchImages(page, searchQuery).then(value => {\n    makeCards(value);\n    if (page === Math.ceil(value.data.totalHits / 40)) {\n      iziToast.show({\n        message:\n          \"We're are sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      refs.loadBtn.classList.add('hidden');\n      return;\n    }\n  });\n}\n\nasync function fetchImages(pag, searchQuery) {\n  if (page !== 1) {\n    iziToast.show({\n      message: 'PLease wait, pictures are loading...',\n      position: 'topRight',\n    });\n  }\n\n  const params = new URLSearchParams({\n    key: KEY,\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pag,\n    per_page: 40,\n  });\n\n  const resp = await axios.get(`?${params}`);\n\n  if (page === 1) {\n    if (resp.data.totalHits === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n          position: \"topRight\",\n      });\n      return;\n    }\n    iziToast.show({\n      message: `Hooray! We found ${resp.data.totalHits} images.`,\n      position: 'topRight',\n    });\n  }\n\n  return resp;\n}\n\nasync function makeCards(response) {\n  const markup = response.data.hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<a href=\"${largeImageURL}\"><div class=\"photo-card\">\n  <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b><br>${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b><br>${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b><br>${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b><br>${downloads}\n    </p>\n  </div>\n</div></a>`;\n      }\n    )\n    .join('');\n  refs.gallery.innerHTML += markup;\n\n  const { height: cardHeight } =\n    refs.gallery.firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight / 2,\n    behavior: 'smooth',\n  });\n\n  refs.loadBtn.classList.remove('hidden');\n  let simplelightbox = new SimpleLightbox('.gallery a', {});\n  simplelightbox.refresh();\n}\n\nconst { height: cardHeight } = document\n  .querySelector('.gallery')\n  .firstElementChild.getBoundingClientRect();\n\nwindow.scrollBy({\n  top: cardHeight / 2,\n  behavior: 'smooth',\n});\n"],"names":["refs","KEY","axios","page","searchQuery","event","fetchImages","value","makeCards","loadMore","iziToast","pag","params","resp","response","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","cardHeight","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAO,CACX,QAAS,SAAS,cAAc,UAAU,EAC1C,KAAM,SAAS,cAAc,cAAc,EAC3C,MAAO,SAAS,cAAc,OAAO,EACrC,QAAS,SAAS,cAAc,YAAY,CAC9C,EAEMC,EAAM,qCACZC,EAAM,SAAS,QAAU,2BACzB,IAAIC,EAAO,EACPC,EAAc,KAElBJ,EAAK,KAAK,iBAAiB,SAAU,MAAMK,GAAS,CAClDA,EAAM,eAAc,EACpBL,EAAK,QAAQ,UAAY,GACzBG,EAAO,EAEPC,EAAcJ,EAAK,MAAM,MAAM,KAAI,EAE9BI,GAGLE,EAAYH,EAAMC,CAAW,EAAE,KAAKG,GAASC,EAAUD,CAAK,CAAC,CAC/D,CAAC,EAEDP,EAAK,QAAQ,iBAAiB,QAASS,CAAQ,EAE/C,eAAeA,GAAW,CACxBT,EAAK,QAAQ,UAAU,IAAI,QAAQ,EACnCG,GAAQ,EACRG,EAAYH,EAAMC,CAAW,EAAE,KAAKG,GAAS,CAE3C,GADAC,EAAUD,CAAK,EACXJ,IAAS,KAAK,KAAKI,EAAM,KAAK,UAAY,EAAE,EAAG,CACjDG,EAAS,KAAK,CACZ,QACE,iEACF,SAAU,UAClB,CAAO,EACDV,EAAK,QAAQ,UAAU,IAAI,QAAQ,EACnC,MACD,CACL,CAAG,CACH,CAEA,eAAeM,EAAYK,EAAKP,EAAa,CACvCD,IAAS,GACXO,EAAS,KAAK,CACZ,QAAS,uCACT,SAAU,UAChB,CAAK,EAGH,MAAME,EAAS,IAAI,gBAAgB,CACjC,IAAKX,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMO,EACN,SAAU,EACd,CAAG,EAEKE,EAAO,MAAMX,EAAM,IAAI,IAAIU,GAAQ,EAEzC,GAAIT,IAAS,EAAG,CACd,GAAIU,EAAK,KAAK,YAAc,EAAG,CAC7BH,EAAS,KAAK,CACZ,QACE,2EACA,SAAU,UACpB,CAAO,EACD,MACD,CACDA,EAAS,KAAK,CACZ,QAAS,oBAAoBG,EAAK,KAAK,oBACvC,SAAU,UAChB,CAAK,CACF,CAED,OAAOA,CACT,CAEA,eAAeL,EAAUM,EAAU,CACjC,MAAMC,EAASD,EAAS,KAAK,KAC1B,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe,YAAYL;AAAA,4BACCD,WAAsBE;AAAA;AAAA;AAAA,wBAG1BC;AAAA;AAAA;AAAA,wBAGAC;AAAA;AAAA;AAAA,2BAGGC;AAAA;AAAA;AAAA,4BAGCC;AAAA;AAAA;AAAA,WAKvB,EACA,KAAK,EAAE,EACVtB,EAAK,QAAQ,WAAae,EAE1B,KAAM,CAAE,OAAQQ,CAAY,EAC1BvB,EAAK,QAAQ,kBAAkB,wBAEjC,OAAO,SAAS,CACd,IAAKuB,EAAa,EAClB,SAAU,QACd,CAAG,EAEDvB,EAAK,QAAQ,UAAU,OAAO,QAAQ,EACjB,IAAIwB,EAAe,aAAc,CAAE,CAAA,EACzC,QAAO,CACxB,CAEA,KAAM,CAAE,OAAQD,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACZ,CAAC"}